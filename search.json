[{"title":"web渗透详细过程之信息收集篇","date":"2021-08-06T08:58:11.000Z","url":"/2021/08/06/web%E6%B8%97%E9%80%8F%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B%E4%B9%8B%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%AF%87/","categories":[["渗透","/categories/%E6%B8%97%E9%80%8F/"]],"content":"Web渗透详细过程之信息收集篇前言在这大千世界中，总有让你心动的目标。当你偶然遇见一位成熟稳重的帅哥，不用我说那内心的小鹿肯定开始乱撞，冰封已久的冰山开始融化。想要把小哥哥追到手，需要一步步来。首先要进行信息收集，需要知道他的个人信息，例如叫什么，联系方式，喜好，在哪里工作，做什么行业，或者家庭住址等等。 收集域名信息通常我们想知道这个心上人叫什么的时候就要想办法得到他的名片，上边一般都会介绍他的姓名，职业，所在单位，单位地址。 在这里对目标进行whois查询，查询域名是否被注册、注册商、DNS。就好比看对方的名片一样。以下介绍几种获取对方名片的方法。 whois查询1、域名whois查询-站长之家  2、IP138网站  3、域名信息查询-腾讯云  4、ICANN LOOKUP  备案信息查询1、SEO综合查询  2、ICP备案查询-站长工具  IP反查站点1、Dnslytics 利用Dnslytics反查IP可以得到如下信息 利用Dnslytics反查域名可以得到如下信息  相关应用信息1、天眼查  2、七麦数据  查找真实IP在一些大的网站都会使用CDN(内容分发网络)，它可以使内容传输的更快、更加稳定。，CDN系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。一般CDN隐藏了目标服务器的真实的IP，也提高了安全性。就像你找人家问他的名字，他就告诉你假的名字或外号，这一看对你兴趣不大啊，这时连心上人的真名字都不知道怎嘛进行下一步，那不凉凉了。这里说下如何识别给你的名字是真的还是假的，给假的名字情况下如何获取真实姓名。 如何判断是否使用CDN1、ping目标主域 通过ping目标主域，观察域名解析情况来判断是否使用CDN。 发现使用了CDN。 2、Nslookup 不同DNS解析结果若不一样，很有可能存在CDN服务。 3、ping检测平台 Ping检测-站长工具地址： 绕过CDN常见方法1、ping主域 有的网站只让www域名使用CDN,可以去掉www在ping下。 2、DNS历史查找 CDN可能是在网站上线一段时间后才上线的，可以通过查找域名解析记录的方式去查找真实IP。以下介绍几个平台   3、查询子域名方法 一般都是主站加入CDN，子域名站点很多没有加入，可以通过子域名来获取，下边有收集子域名详细介绍，在这里举例一个。  4、网站邮件头信息 比如说，邮箱注册，邮箱找回密码、RSS邮件订阅等功能场景，通过网站给自己发送邮件，从而让目标主动暴露他们的真实的IP，查看邮件头信息，获取到网站的真实IP。注意：必须是目标自己的邮件服务器，第三方或公共邮件服务器是没有用的。 5、网络空间搜索引擎法 通过关键字或网站域名，就可以找出被收录的IP，很多时候获取到的就是网站的真实IP。 钟馗之眼：：： 6、网站漏洞查找 通过网站的信息泄露如phpinfo泄露，github信息泄露，命令执行等漏洞获取真实ip。 收集子域名之前已经获取地址和姓名了，那就让我们大声把爱说出来。万一和心上人表白失败了，我们不要放弃，毕竟这样不容得到的男人才香啊，之前了解他的工作单位了或者家庭地址了，我们可以从他的同事或者邻居入手，通常这样更容易获取汉子的信息，方便更加深入的了解他。说不定能从同事或者邻居那边美言下，拿下这个高冷的男人了。 在线平台1、IP138  2、站长工具  3、hackertarget  4、phpinfo  5、dnsdumpster  6、zcjun  7、Censys  IP反查绑定域名网站1、chinaz  2、爱站  3、webscan.cc  资产搜索引擎个人常用的有Google、FOFA，也可以使用Shodan、zoomeye钟馗之眼. 1、Google语法 常用语法 2、FOFA语法 可以在首页点击查询语法来查看 工具枚举在这里常用的sublist3r、OneForAll、subDomainsBrute. 1、sublist3r 下载地址: 2、OneForAll 下载地址：运行完成后会生成一个csv文件 3、subDomainsBrute 下载地址： 利用DNS收集常见的DNS记录有以下几类： MX记录： 建立电子邮箱服务，将指向邮件服务器地址，需要设置MX记录。建立邮箱时，一般会根据邮箱服务商提供的MX记录填写此记录。 NS记录： 域名解析服务器记录，如果要将子域名指定某个域名服务器来解析，需要设置NS记录。 SOA记录： SOA叫做起始授权机构记录，NS用于标识多台域名解析服务器，SOA记录用于在众多NS记录中那一台是主服务器。 TXT记录： 可任意填写，可为空。一般做一些验证记录时会使用此项，如：做SPF（反垃圾邮件）记录。 DNS域传送漏洞 1、原理：DNS服务器分为：主服务器、备份服务器和缓存服务器。在主备服务器之间同步数据库，需要使用“DNS域传送”。域传送是指备份服务器从主服务器拷贝数据，并用得到的数据更新自身数据库。 若DNS服务器配置不当，可能导致攻击者获取某个域的所有记录。造成整个网络的拓扑结构泄露给潜在的攻击者，包括一些安全性较低的内部主机，如测试服务器。同时，黑客可以快速的判定出某个特定zone的所有主机，收集域信息，选择攻击目标，找出未使用的IP地址，绕过基于网络的访问控制。2、DNS域传送漏洞检测基本过程 nslookup #进入交互式shell server dns.xx.yy.zz #设定查询将要使用的DNS服务器 ls xx.yy.zz #列出某个域中的所有域名 exit #退出漏洞检测-不存在漏洞 站点信息收集乖乖，现在撩汉子容易吗，咱们接下来在了解下他的爱好，喜欢健身还是喜欢去娱乐场所还是宅在家里，出去玩的话都去哪里玩，喜欢吃什么等等。为咱们下一步攻势做好准备，就不信俘获不到小哥哥的芳心。 判断对方是win还是Linux1、TTL值 可以通过ping来查看，不过不一定非常准可以被修改，默认Linux是64，win是128win： Linux： 2、Nmap 使用命令：nmap -O IP 端口收集nmap CMS指纹识别CMS（内容管理系统）用于网站内容管理，通过识别CMS类型可以查看相应的漏洞拿下站点。如今，网上一些在线的网站查询CMS指纹识别，如下所示：BugScaner: 潮汐指纹：云悉：: 云悉指纹: :  目录扫描1、御剑扫描 2、dirbuster 首先在Target URL输入框中输入要扫描的网址并将扫描过程中的请求方法设置为“Auto Switch(HEAD and GET)”。自行设置线程（太大了容易造成系统死机哦）选择扫描类型，如果使用个人字典扫描，则选择“List based bruteforce”选项。单击“Browse”加载字典。单机“URL Fuzz”，选择URL模糊测试（不选择该选项则使用标准模式）在URL to fuzz里输入“/{dir}”。这里的{dir}是一个变量，用来代表字典中的每一行，运行时{dir}会被字典中的目录替换掉。点击“start”开始扫描 也可以使用kali自带的 3、dirscan 下载地址： 4、dirsearch 下载地址： Google Hacking他基本语法上边有介绍，介绍下典型用法： 查找指定后台地址 查看指定网站的文件上传漏洞 注入页面 目录遍历漏洞 SQL错误 phpinfo() 配置文件泄露 数据库文件泄露 日志文件泄露 备份和历史文件泄露 公开文件泄露 邮箱信息 社工信息 通过用户的一些信息（Mail、Name、ID、Tel）查询用户注册过哪些应用 Github信息泄漏很多网站及系统都会使用pop3和smtp发送来邮件，不少开发者由于安全意识不足会把相关的配置文件信息也放到Github上，所以如果这时候我们动用一下Google搜索语法，就能把这些敏感信息给找出来了。 site:Github.com smtpsite:Github.com smtp @qq.comsite:Github.com smtp @126.comsite:Github.com smtp @163.comsite:Github.com smtp @sina.com.cn 数据库信息泄露： site:Github.com sa passwordsite:Github.com root password 总结要想拿下小哥哥当然要一步步来，前边的信息收集工作是非常重要的。从开始的选择目标，到获取简单的个人信息，如何看对方是否欺骗自己，再到如果拒绝失败从他身边的人下手。可以说能否追求成功这个收集工作起到至关重要的位置。主要是用来新手之间互相交流下经验，老司机可以继续开车了。 参考文档：   "},{"title":"渗透测试基本思路","date":"2021-08-05T07:12:05.000Z","url":"/2021/08/05/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF/","tags":[["信息收集","/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"],["漏洞扫描","/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/"]],"categories":[["渗透","/categories/%E6%B8%97%E9%80%8F/"]],"content":"​ 有人问我，渗透到底做啥，web渗透到底是干什么，当你拿到一个待检测得站或网站，需要做什么。以我得经验其实web渗透是一个非常简单得事情。今天我就以个人经验来谈一谈怎么去渗透一个网站。 一、信息收集 获取域名的 whois 信息,获取注册者邮箱姓名电话等。 通过站长之家、明小子、k8 等查询服务器旁站以及子域名站点，因为主站一般比较难， 所以先看看旁站有没有通用性的 cms 或者其他漏洞。 通过 DNS 域传送漏洞、备份号查询、SSl 证书、APP、微信公众号、暴力破解、DNS 历史记录、K8 C 段查询、Jsfinder、360 或华为威胁情报、证书序列号获取企业域名与 ip。 通过 Nmap、Wappalyzer、御剑等查看服务器操作系统版本，web 中间件，看看是否存在已知的漏洞，比如 IIS，APACHE,NGINX 的解析漏洞 通过 7KB、破壳扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄漏，比如php 探针、管理员备份文件。 google hack 进一步探测网站的信息，后台，敏感文件 敏感信息收集，如 github 源码、用 7kb、破壳扫源代码泄露（.hg、.git、cvs、svn、.DS_store 源代码泄露）、google hack、接口信息泄露、社工信息泄露、邮箱地址信息收集、网盘搜索、钟馗之眼、天眼查、威胁情报、微步在线等 通过Wappalyzer、御剑工具对网站指纹识别（包括，cms，cdn，证书等），dns 记录 二、漏洞扫描 用 AWVS、APPSCAN、长亭科技的 Xray 等扫描器检测 Web 漏洞，如 XSS,XSRF,sql 注入，代码执行，命令执行，越权访问，目录读取，任意文件读取，下载，文件包含， 远程命令执行，弱口令，上传，编辑器漏洞，暴力破解等 用 namp、天镜、Nessus、极光等扫描系统 ip，对扫描出来的高危漏洞进行测试，如ms08-067、ms17-010、ms12-020、ms15-035、ms19-0708、永恒之蓝 2 代、cve-2017-7494（samba）、cve-2014-6271(破壳)、php cgi 等相关漏洞验证。 漏洞利用 ​ 利用以上的方式拿到 webshell，或者其他权限 4.权限提升 ​ 提权服务器，比如 windows 下 mysql 的 udf 提权，serv-u 提权，windows 低版本的漏洞， 如 iis6,pr,巴西烤 肉，linux 脏牛漏洞，linux 内核版本漏洞提权，linux 下的 mysql system 提权以及 oracle 低权限提权 5.日志清理 ​ 操作系统、中间件、数据库等日志进行清除 6.总结报告及修复方案"},{"title":"SQL手工注入入门教程","date":"2021-08-03T09:11:01.000Z","url":"/2021/08/03/%E6%B8%97%E9%80%8F%E7%AC%AC%E4%B8%80%E8%AF%BE/","tags":[["sql 注入","/tags/sql-%E6%B3%A8%E5%85%A5/"]],"categories":[["渗透","/categories/%E6%B8%97%E9%80%8F/"]],"content":"mysql基本hack函数：mid SELECT MID(ColumnName, Start [, Length]) FROM TableName LEFT(str,len) 返回字符串str的最左面len个字符 ASCII(str) =ORD 返回字符串str的最左面字符的ASCII代码值。如果str是空字符串，返回0。如果str是NULL，返回NULL SUBSTR(str,pos,len) 从str中多少个字符开始，截取多少位 CAST SELECT CAST(’12’ AS int) 将目标str转化为目标数据类型 IFNULL(expr1,expr2) 如果expr1不是NULL，IFNULL()返回expr1，否则它返回expr2 updatexml() extracavalue() 判断字符的一些语句： LOAD_FILE加载本地文件（服务器上） 说明：“char(99,58,47,98,111,111,116,46,105,110,105)”就是“c:/boot.ini”的 ASCII 代码 说明：“c:/boot.ini”的 16 进制是“0x633a2f626f6f742e696e69” select load_file(‘c:\\wamp\\bin\\mysql\\mysql5.6.17\\my.ini’) into outfile‘c:\\wamp\\www\\test.php’ 可以将其他路径的文件导到web目录来供访问，一般用于把包含一句话木马的文件导出成php来链接 get与post请求注释符的区别一般很容易在各种教程上看到 ‘ or and 1=1 # 或 ‘ or and 1=1 –+ 但可能没人告诉你什么情况下该用什么。 #是sql语句中的注释符，+ 在http请求中表示空格，但get与post中，由于http请求的转义，请求到后端sql语句拼接的时候可能会不一样。 get请求的时候一般用: 1′ and 1=1 –+ //这里最后的空格用+，在请求的时候不会被urlencode，到后端sql语句中就会成为一个正常的空格，– 后面的语句就会被注释。 但是如果在post里最后用加号的话就会被urlencode成%2B，实际的空格被转义才被转义成+ post请求的时候一般用： 这时候，在post的情况下，最后一个空格，可以直接用空格，不用+来代替，因为post参数 空格会自动转成+； 而之所以不在get注入的时候使用“#”来注释，是因为，请求时，“#”不会被urlencode为“%23”，被识别为锚链接，无法传递至sql语句中。 找一个库中有哪些表名： 找一个表中有哪些列名： AND与OR的区别需要理解 and和or的区别 场景举例： 没有订单可以测的情况下，只能用or union联合查询注入当union前面的语句为false时才会执行后面语句（这里一定先学习union查询的用法） 如以下，union语句前 先构建一个错误条件。 union与order by 后面跟着的列数是跟前面的select 列数相同的，不是该表的总列数 总列数判断为： 解释：如果列数为2，则延时5秒响应。 判断某列是否存在也可以用： 当union查同库其他表时，需要知道库名： 如： 读文件/写shell这里包含了网上常见或不常见的导出一句话的骚操作 支持union的方法，最常规的方式： 16进制写shell 其中上面的16 进制组合成的是一个一句话，其实这样的sql可以过waf 利用分隔符写shell 如果不支持union，可以用分隔符导出一句话，当然字段数要大于2。 修改sql日志路径到web下的一个php文件 读文件： 基于布尔值的盲注可以通过响应的不同可以判断sql语句是否正确 枚举字符来判断字符是否存在 mysql的一些特征： 当试探第二个表的时候并不是改为limit1,1，因为limit针对的是条件筛选后的过滤，所以测试其他表的时候，继续修改正则即可，如果us[a-z]为1，ua[a-z]，说明至少有两个表，一个表以us开头，另一个ua开头 标准的正则布尔测试： 比如判断数据库版本： 判断是否条件成立的其他方法： 盲注流程获取库名： and%20ord(substr(database(),1,1))&gt;80+–+ 获取表名： 利用 substr() ascii()函数进行尝试 获取字段名： 获取表数据： 通过dns获取盲注数据： 由于union后必须跟上与前面同样的字段数，所以需要把load_file放在其中，非union直接select load_file即可 dns获取盲注数据示例： \\foobar 后面要有一串任意字符，访问远程目录的意思，所以这个“foobar”可以用任意字符替换。 还可以： 延时注入适用于当我们测试的时候没有任何回显来判断是否有注入，比如订单搜索，比如当sql错误的时候返回与正确的相同，我们就无法通过回显差异来判断注入 如下图代码，成立与否页面不变化 延时注入 适用于当我们测试的时候没有任何回显来判断是否有注入，比如订单搜索，比如当sql错误的时候返回与正确的相同，我们就无法通过回显差异来判断注入 如下图代码，成立与否页面不变化 所以就需要通过判断是否延时来确认是否有注入 如果过滤逗号，可以： 还可以利用 union select 加 order by 逐字猜解… 假设，name 是 admin 当 猜出第一个字母为 ‘a’ 时，’a’=’a’及真。用 0，1表示的话就是1，然后 sleep(15)，如果是假，那就是sleep(05)… 先基本判断有没有延时，然后在load_file来dns查询 可以 post注入最大的区别在于注释符的使用，and改为or而已 如： 参考文章："},{"title":"hexo 命令行","date":"2021-08-02T15:34:52.121Z","url":"/2021/08/02/hexo%E5%91%BD%E4%BB%A4%E8%A1%8C/","categories":[["undefined",""]],"content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post More info: Writing Run server More info: Server Generate static files More info: Generating Deploy to remote sites More info: Deployment"},{"title":"hello-world","date":"2021-05-02T09:30:00.000Z","url":"/2021/05/02/my-first-blog/","categories":[["日常","/categories/%E6%97%A5%E5%B8%B8/"]],"content":"Hello, World是指在电脑屏幕显示“Hello, World!”（你好，世界！）字符串的计算机程序。相关的程序通常都是每种电脑编程语言最基本、最简单的程序，也会用作示范一个编程语言如何运作。同时它亦可以用来确认一个编程语言的编译器、程序开发环境及运行环境是否已经安装妥当。因为写法简单可见，这也是很多初学者首次接触编程语言时会撰写的程序。 成功啦o(￣▽￣)ブ 有危险Σ(っ °Д °;)っ 有消息(・∀・(・∀・(・∀・*) 当心哦≧ ﹏ ≦ 折叠框的标题 被折叠的内容 1被折叠的内容 2… TYPE是面板框的类型，可以是： successsdangerinfowarning "}]